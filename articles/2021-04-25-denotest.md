---
title: "Deno ãƒ†ã‚¹ãƒˆç’°å¢ƒæ§‹ç¯‰ (Vim)"
emoji: "ğŸœ"
type: "idea" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["vim", "neovim", "deno"]
published: true
---

[Deno](https://deno.land/) ã®ãƒ†ã‚¹ãƒˆã‚’ã„ã„æ„Ÿã˜ã« `Vim` ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ç’°å¢ƒæ§‹ç¯‰ã€‚

<!-- more -->

## vim-test ã®å°å…¥

ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã«ã¯ã€ä»¥ä¸‹ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæœ‰åãã†ã ã£ãŸã®ã§å°å…¥ã€‚

https://github.com/vim-test/vim-test

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ [dein.vim](https://github.com/Shougo/dein.vim) ã ã¨ã“ã‚“ãªæ„Ÿã˜ã€‚

```toml
[[plugins]]
repo = 'vim-test/vim-test'
depends = ['neoterm']
on_cmd = ['TestNearest', 'TestFile', 'TestSuite', 'TestLast', 'TestVisit']
hook_add = '''
nnoremap <silent> <space>tn <cmd>TestNearest<cr>
nnoremap <silent> <space>tf <cmd>TestFile<cr>
nnoremap <silent> <space>ts <cmd>TestSuite<cr>
nnoremap <silent> <space>tl <cmd>TestLast<cr>
nnoremap <silent> <space>tg <cmd>TestVisit<cr>

let test#strategy = {
	\ 'nearest': 'neoterm',
	\ 'file'   : 'neoterm',
	\ 'suite'  : 'neoterm',
	\ }

let test#javascript#denotest#options = {
    \ 'all': '--no-check --unstable -A'
    \ }
'''

[[plugins]]
repo = 'kassio/neoterm'
on_cmd = ['Tnew']
hook_add = '''
let g:neoterm_autoinsert = 1
let g:neoterm_autoscroll = 1
let g:neoterm_default_mod = 'botright'
let g:neoterm_size = 10
'''
```

[vim-test](https://github.com/vim-test/vim-test) ã ã¨ã€ `strategy` ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã«ä½•ã‚’ä½¿ç”¨ã™ã‚‹ã‹é¸ã¶ã“ã¨ãŒã§ãã‚‹ã€‚
è‰²ã€…è©¦ã—ãŸçµæœã€ [kassio/neoterm](https://github.com/kassio/neoterm) ãŒè‰¯ã•ãã†ã ã£ãŸã®ã§ã“ã‚Œã‚’ä½¿ç”¨ä¸­ã€‚
è¦‹ãˆæ–¹ã¨ã‹å¤‰ã‚ã‚‹ãã‚‰ã„ã‚„ã‹ã‚‰æ­£ç›´ã“ã‚Œã¯ãªã‚“ã§ã‚‚ã„ã„ã¨æ€ã†ã€‚
ä½•ãŒé¸ã¹ã‚‹ã‹ã¯ [vim-test/vim-test: strategies](https://github.com/vim-test/vim-test#strategies) ã‚’å‚ç…§ã€‚

## Deno test æ§‹æˆ

[Deno](https://deno.land/) ã®ãƒ†ã‚¹ãƒˆã§ã¯çµ„ã¿è¾¼ã¿ã® `Deno.test` é–¢æ•°ãŒã‚ã‚‹ã®ã§ãã‚ŒãŒä½¿ç”¨ã§ãã‚‹ã€‚
åŸºæœ¬çš„ã«å®Ÿè£…ãŒ `mod.ts` ã«è¨˜è¼‰ã—ã¦ã‚ã‚‹ã¨ã™ã‚‹ã¨ã€ãƒ†ã‚¹ãƒˆã¯ `mod_test.ts` ã«è¨˜è¼‰ã™ã‚‹ã£ã½ã„ã€‚
(å¾Œã‚ã« `_test` ã‚’ã¤ã‘ã‚‹ã€‚)

ã‹ã‚“ãŸã‚“ã«ä¾‹ã‚’æ›¸ãã¨ã“ã‚“ãªæ„Ÿã˜ã€‚

- mod.ts

```typescript
export const getTrue = (): boolean => {
  return true;
};

export const add = (x: number, y: number): number => {
  return x + y;
};
```

- mod_test.ts

```typescript
import {
  assert,
  assertEquals,
} from "https://deno.land/std@0.95.0/testing/asserts.ts";
import { add, getTrue } from "./mod.ts";

Deno.test("getTrue test", () => {
  assert(getTrue());
});

Deno.test("add test", () => {
  const expected = 2;
  const actual = add(1, 1);
  assertEquals(actual, expected);
});
```

`mod_test.ts` ã‚’é–‹ã„ã¦ã€ `Deno.test("getTrue")` ã®ä»˜è¿‘ã«ã‚«ãƒ¼ã‚½ãƒ«ãŒã‚ã‚‹çŠ¶æ…‹ã§ `<space>tn` ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã« `getTrue` ã®ã¿ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚

![TestNearest](https://github.com/yukimemi/zenn-dev/blob/master/articles/img/2021-04-25_TestNearest.png?raw=true)

`<space>tf` ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã« `mod_test.ts` ã®ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒå®Ÿè¡Œã•ã‚Œã‚‹ã€‚

![TestFile](https://github.com/yukimemi/zenn-dev/blob/master/articles/img/2021-04-25_TestFile.png?raw=true)

ã¹ã‚“ã‚Šã€‚

---

#### å‚è€ƒ

- [Manual | Deno](https://deno.land/manual/testing)
- [vim-test/vim-test: Run your tests at the speed of thought](https://github.com/vim-test/vim-test)
- [kassio/neoterm: Wrapper of some vim/neovim's :terminal functions.](https://github.com/kassio/neoterm)
